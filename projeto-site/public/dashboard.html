<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Creative - Bootstrap 3 Responsive Admin Template">
    <meta name="author" content="GeeksLabs">
    <meta name="keyword" content="Creative, Dashboard, Admin, Template, Theme, Bootstrap, Responsive, Retina, Minimal">
    <link rel="shortcut icon" href="img/favicon.png">
    <title>Dashboard-Oceantec</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-theme.css" rel="stylesheet">
    <link href="css/elegant-icons-style.css" rel="stylesheet" />
    <link href="css/font-awesome.min.css" rel="stylesheet" />
    <link href="assets/fullcalendar/fullcalendar/bootstrap-fullcalendar.css" rel="stylesheet" />
    <link href="assets/fullcalendar/fullcalendar/fullcalendar.css" rel="stylesheet" />
    <link href="assets/jquery-easy-pie-chart/jquery.easy-pie-chart.css" rel="stylesheet" type="text/css" media="screen" />
    <link rel="stylesheet" href="css/owl.carousel.css" type="text/css">
    <link href="css/jquery-jvectormap-1.2.2.css" rel="stylesheet">
    <link rel="stylesheet" href="css/fullcalendar.css">
    <link href="css/widgets.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/style-responsive.css" rel="stylesheet" />
    <link href="css/xcharts.min.css" rel=" stylesheet">
    <link href="css/jquery-ui-1.10.4.min.css" rel="stylesheet">
    <link href="../node_modules/sweetalert2/dist/sweetalert2.css" rel="stylesheet">
    <script type="text/javascript" src="funcoes.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>

    <style>
        /* Classes CSS para exemplos de alertas */
        
        .normal {
            background-color: white;
        }
        
        .alerta {
            background-color: tomato;
        }
    </style>


</head>

<body onload="atualizartudo()">
    <section id="container" class="">

        <!-- barra superior -->

        <header class="header dark-bg">
            <div class="toggle-nav">
                <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"><i class="icon_menu"></i></div>
            </div>


            <a href="dashboard.html" class="logo">Coral <span class="lite">Life</span></a>


            <div class="nav search-row" id="top_menu">

                <ul class="nav top-menu">
                    <li>
                        <form class="navbar-form">
                            <input class="form-control" placeholder="Search" type="text">
                        </form>
                    </li>
                </ul>

            </div>

            <div class="top-nav notification-row">

                <ul class="nav pull-right top-menu">

                    <!-- box de informações -->
                    <li id="task_notificatoin_bar" class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <i class="icon-task-l"></i>
                            <span class="badge bg-important">6</span>
                        </a>
                        <ul class="dropdown-menu extended tasks-bar">
                            <div class="notify-arrow notify-arrow-blue"></div>
                            <li>
                                <p class="blue">Suas atualizações</p>
                            </li>
                            <li>
                                <a href="#">
                                    <div class="task-info">
                                        <div class="desc">Estatisticas anuais</div>
                                        <div class="percent">90%</div>
                                    </div>
                                    <div class="progress progress-striped">
                                        <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100" style="width: 90%">
                                            <span class="sr-only">90% Completo</span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <div class="task-info">
                                        <div class="desc">
                                            Estatistica Diaria
                                        </div>
                                        <div class="percent">30%</div>
                                    </div>
                                    <div class="progress progress-striped">
                                        <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100" style="width: 30%">
                                            <span class="sr-only">30% Complete (warning)</span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li class="external">
                                <a href="#"></a>
                            </li>
                        </ul>
                    </li>

                    <li id="mail_notificatoin_bar" class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <i class="icon-envelope-l"></i>
                            <span class="badge bg-important">5</span>
                        </a>
                        <ul class="dropdown-menu extended inbox">
                            <div class="notify-arrow notify-arrow-blue"></div>
                            <li>
                                <p class="blue">Você possui 5 mensagens</p>
                            </li>
                            <li>
                                <a href="#">Ver mensagens</a>
                            </li>
                        </ul>
                    </li>
                    <li id="alert_notificatoin_bar" class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">

                            <i class="icon-bell-l"></i>
                            <span id="notificação" class="badge bg-important">3</span>
                        </a>
                        <ul class="dropdown-menu extended notification">
                            <div class="notify-arrow notify-arrow-red"></div>
                            <li>
                                <a href="#">Ver notificações</a>
                                <a href="#">
                                    <div class="task-info">
                                        <div class="desc">
                                            Estatistica Diaria
                                        </div>
                                        <div class="percent">30%</div>
                                    </div>
                                    <div class="progress progress-striped">
                                        <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100" style="width: 30%">
                                            <span class="sr-only">30% Complete (warning)</span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="profile-ava">
                <img alt="" src="img/avatar2.png" width=40 height=40>
                <b id="b_usuario"></b>
             
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu extended logout">
                            <li class="eborder-top">
                                <a href="/usuario.html"><i class="icon_profile"></i> Meu perfil</a>
                            </li>
                            <li>
                                <a href="#"><i class="icon_mail_alt"></i> Caixa de email</a>
                            </li>
                            <li>
                                <a onclick="logoff()"><i class="fas fa-exit prefix grey-text"></i></i>Sair</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </header>
        <!-- Menu lateral -->
        <aside>
            <div id="sidebar" class="nav-collapse ">

                <ul class="sidebar-menu">
                    <li class="active">
                        <a class="" href="dashboard.html">
                            <i class="icon_house_alt"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="sub-menu">
                        <a href="/relatorio" class="">
                            <i class="icon_document_alt"></i>
                            <span>Relatorio</span>
                            <span class="menu-arrow arrow_carrot-right"></span>
                        </a>
                    </li>
                    <li class="sub-menu">
                        <a href="./chart-chartjs.html" class="">
                            <i class="icon_desktop"></i>
                            <span>Estatisticas</span>
                            <span class="menu-arrow arrow_carrot-right"></span>
                        </a>
                        <ul class="sub">
                        </ul>
                    </li>
                    </li>
                </ul>

            </div>
            </aside>
            <!-- Mapa central -->
            <section id="main-content">
                <section class="wrapper">

                    <div class="row">
                    </div>
                    <div class="row">
                        <div class="col-lg-9 col-md-12">

                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h2><i class="fa fa-map-marker red"></i><strong>Localização Domos</strong></h2>
                                    <div class="panel-actions">
                                        <a href="index.html#" class="btn-setting"><i class="fa fa-rotate-right"></i></a>
                                        <a href="index.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                                        <a href="index.html#" class="btn-close"><i class="fa fa-times"></i></a>
                                    </div>
                                </div>
                                <div class="panel-body-map" a>
                                    <div id="map" style="height:400px;color: rgb(11, 80, 80)">
                                        <!--Botão modal-->
                                        <a type="button" class="bolinha1" data-toggle="modal" data-target="#centralModalSm1">
                                        </a>
                                        <a type="button" class="bolinha2" data-toggle="modal" data-target="#centralModalSm2">
                                        </a>
                                        <a type="button" class="bolinha3" data-toggle="modal" data-target="#centralModalSm3">
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="col-md-3">
                            <!-- graficos gerais lateral -->
                            <ul class="today-datas">
                                <li>

                                </li>
                                <li>
                                    Media de Temperatura Atual

                                    <div class="card-bod">
                                        <div class="media" id="media_atual" style="width: 200px; height: 100px; border: solid 2px rgb(5, 126, 65);"></div>
                                    </div>


                                </li>


                        </div>

                        </ul>
                    </div>
                    </div>
                    <!-- Caixa de informação -->
                    <div class="row">

                        <div class="col-lg-9 col-md-12">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h2><i class="fa fa-flag-o red"></i><strong>Registro</strong></h2>
                                    <div class="panel-actions">
                                        <a href="index.html#" class="btn-setting"><i class="fa fa-rotate-right"></i></a>
                                        <a href="index.html#" class="btn-minimize"><i class="fa fa-chevron-up"></i></a>
                                        <a href="index.html#" class="btn-close"><i class="fa fa-times"></i></a>
                                    </div>
                                </div>
                                <div class="panel-body">
                                    <table class="table bootstrap-datatable countries">
                                        <thead>
                                            <tr>
                                                <th></th>
                                                <th>Localização</th>
                                                <th>Nome</th>
                                                <th></th>
                                                <th>Temperatura</th>
                                                <th>Status</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <td><img src="./img/ba.png" style="height:18px; margin-top:-2px;"></td>
                                            <td>Bahia</td>
                                            <td>Barreira de corais</td>
                                            <td></td>
                                            <td>
                                                <div style="width:75%;">
                                                    <div id="div_temperatura">Temperatura sendo obtida...</div>
                                                    <div id="mensagem"></div>
                                                    <div id="normal"></div>

                                                </div>

                                            </td>
                                            <td>
                                                <span class="" id="message">Status</span>
                                            </td>
                                            </tr>
                                            <tr>
                                                <td><img src="img/alagoas.png" style="height:18px; margin-top:-2px;"></td>
                                                <td>Alagoas</td>
                                                <td>Barreira de maragogi</td>
                                                <td></td>
                                                <td>
                                                    <div style="width:75%;">
                                                        <div id="div_temperatura1">Temperatura sendo obtida...</div>
                                                        <div id="mensagem"></div>
                                                        <div id="normal"></div>
                                                    </div>
                                                    <span class="sr-only">20%</span>
                                                </td>

                                                <td>
                                                    <span class="" id="message2">Status</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td><img src="img/rn.png" style="height:18px; margin-top:-2px;"></td>
                                                <td>Rio grande do norte</td>
                                                <td>Barra de são miguel</td>
                                                <td></td>
                                                <td>
                                                    <div style="width:75%;">
                                                        <div id="div_temperatura2">Temperatura sendo obtida...</div>
                                                        <div id="mensagem"></div>
                                                        <div id="normal"></div>
                                                    </div>
                                                    <span class="sr-only">20%</span>
                                                </td>
                                                <td>
                                                    <span class="" id="message3">Status</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                            </div>

                        </div>
                        <div class="col-md-3">
                        </div>
                        <div class="col-md-3">
                        </div>

                        <div class="col-md-3">
                        </div>
                    </div>
                    <div class="row"> </div>
                    </div>

                </section>
                <div class="text-right">
                    <div class="credits">

                    </div>
                </div>
            </section>
    </section>


    <!--Modal-->
    <!-- Button trigger modal -->


    <!-- Modal -->
    <div class="modal fade" id="centralModalSm1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title w-100" id="myModalLabel">Dashboard Bahia-BA</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
                </div>
                <div class="modal-body">
                    <div style="width:75%;">
                        <div id="div_grafico">Dados sendo obtidos...</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-sm" data-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="centralModalSm2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title w-100" id="myModalLabel">Dashboard Bahia-BA</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
                </div>
                <div class="modal-body">
                    <div style="width:75%;">
                        <div id="div_grafico1">Dados sendo obtidos...</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-sm" data-dismiss="modal">Fechar</button>

                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="centralModalSm3" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title w-100" id="myModalLabel">Dashboard Alagoas-AL</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
                </div>
                <div class="modal-body">
                    <div style="width:75%;">
                        <div id="div_grafico2">Dados sendo obtidos...</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-sm" data-dismiss="modal">Fechar</button>

                </div>
            </div>
        </div>
    </div>
    <script src="js/jquery.js"></script>
    <script src="js/jquery-ui-1.10.4.min.js"></script>
    <script src="js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui-1.9.2.custom.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.scrollTo.min.js"></script>
    <script src="js/jquery.nicescroll.js" type="text/javascript"></script>
    <script src="assets/jquery-knob/js/jquery.knob.js"></script>
    <script src="js/jquery.sparkline.js" type="text/javascript"></script>
    <script src="assets/jquery-easy-pie-chart/jquery.easy-pie-chart.js"></script>
    <script src="js/owl.carousel.js"></script>
    <script src="js/fullcalendar.min.js"></script>
    <script src="assets/fullcalendar/fullcalendar/fullcalendar.js"></script>

    <script src="js/calendar-custom.js"></script>
    <script src="js/jquery.rateit.min.js"></script>

    <script src="js/jquery.customSelect.min.js"></script>
    <script src="assets/chart-master/Chart.js"></script>
    <script src="js/scripts.js"></script>
    <!-- Script da pagina-->
    <script src="js/sparkline-chart.js"></script>
    <script src="js/easy-pie-chart.js"></script>
    <script src="js/jquery-jvectormap-1.2.2.min.js"></script>
    <script src="js/jquery-jvectormap-world-mill-en.js"></script>
    <script src="js/xcharts.min.js"></script>
    <script src="js/jquery.autosize.min.js"></script>
    <script src="js/jquery.placeholder.min.js"></script>
    <script src="js/gdp-data.js"></script>
    <script src="js/morris.min.js"></script>
    <script src="js/sparklines.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/jquery.slimscroll.min.js"></script>
    <script>
        $(function() {
            $(".knob").knob({
                'draw': function() {
                    $(this.i).val(this.cv + '%')
                }
            })
        });

        $(document).ready(function() {
            $("#owl-slider").owlCarousel({
                navigation: true,
                slideSpeed: 300,
                paginationSpeed: 400,
                singleItem: true

            });
        });


        $(function() {
            $('select.styled').customSelect();
        });


        $(function() {
            $('#map').vectorMap({
                map: 'world_mill_en',
                series: {
                    regions: [{
                        values: gdpData,
                        scale: ['#000', '#000'],
                        normalizeFunction: 'polynomial'
                    }]
                },
                backgroundColor: '#eef3f7',
                onLabelShow: function(e, el, code) {
                    el.html(el.html() + ' (GDP - ' + gdpData[code] + ')');
                }
            });
        });
    </script>

    <script>
        verificar_autenticacao();
    </script>


    <script>
        let usuario;


        // Não mexa nestas 2 linhas! 
        //google.load('current', {'packages':['gauge']});
        //google.charts.setOnLoadCallback(obterDadosGrafico);
        google.load('visualization', '1', {
            packages: ['corechart', 'gauge'],
            callback: obterDadosGrafico
        });
        // Não mexa nessas 2 linhas! 

        // só mexer se quiser alterar o tempo de atualização
        // ou se souber o que está fazendo!
        function atualizarGrafico() {
            obterDadosGrafico();
            setTimeout(atualizarGrafico, 3000);
        }

        // altere aqui as configurações do gráfico
        // (tamanhos, cores, textos, etc)
        function configurarGrafico() {
            // os valores de yellowTo, yellowTo, redFrom e redTo
            // podem vir de um outro EndPoint
            var configuracoes = {
                temperatura: {
                    width: 100,
                    height: 100,
                    yellowFrom: 00,
                    yellowTo: 20,
                    yellowColor: 'cyan',
                    redFrom: 30,
                    redTo: 60,
                    max: 60,
                    minorTicks: 5
                },

            }

            return configuracoes;
        }

        // altere aqui como os dados serão exibidos
        // e como são recuperados do BackEnd
        function obterDadosGrafico() {
            var dados;

            fetch('/leituras/tempo-real', {
                    cache: 'no-store'
                }).then(function(response) {
                    if (response.ok) {
                        response.json().then(function(resposta) {

                            console.log(`Dados recebidos: ${JSON.stringify(resposta.temperaturaEvento
                                )}`);

                            // aqui, após registro. use os nomes 
                            // dos atributos que vem no JSON 
                            // que gerou na consulta ao banco de dados
                            dadosTemperatura = google.visualization.arrayToDataTable([
                                ['Label', 'Value'],
                                ['Temperatura', resposta.temperaturaEvento]
                            ]);

                            dadosTemperatura2 = google.visualization.arrayToDataTable([
                                ['Label', 'Value'],
                                ['Temperatura', resposta.temperaturaEvento - 10]
                            ]);
                            dadosTemperatura3 = google.visualization.arrayToDataTable([
                                ['Label', 'Value'],
                                ['Temperatura', resposta.temperaturaEvento - 5]
                            ]);


                            var dados = {
                                temperatura: dadosTemperatura,
                                temperatura2: dadosTemperatura2,
                                temperatura3: dadosTemperatura3
                            }

                            var temp = {
                                temperatura1: resposta.temperaturaEvento,
                                temperatura2: Number(resposta.temperaturaEvento) - 10,
                                temperatura3: Number(resposta.temperaturaEvento) - 5,
                            }
                            alertar(temp);
                            plotarGrafico(dados);
                        });
                    } else {
                        console.error('Nenhum dado encontrado ou erro na API');
                    }
                })
                .catch(function(error) {
                    console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
                });

        }

        function alertar(temperatura) {
            // ideal que venham de algum EndPoint
            var limites = {
                max_temperatura: 20,
                min_temperatura: 15,
            };

            var mensagem = '';

            if (temperatura.temperatura1 > 15 && temperatura.temperatura1 < 20) {
                message.innerHTML = '<b style="color:green">Temperatura normal</b> <br> Ideal'
            }
            if (temperatura.temperatura1 >= limites.max_temperatura) {
                message.innerHTML = '<b style="color:red">Temperatura Alta</b> <br> Critico'
            }
            if (temperatura.temperatura1 <= limites.min_temperatura) {
                message.innerHTML = '<b style="color:blue">Temperatura Baixa</b> <br> Critico'
            }
            if (temperatura.temperatura2 > 15 && temperatura.temperatura2 < 20) {
                message2.innerHTML = '<b style="color:green">Temperatura normal</b> <br> Ideal'
            }
            if (temperatura.temperatura2 >= limites.max_temperatura) {
                message2.innerHTML = '<b style="color:red">Temperatura Alta</b> <br> Critico'
            }
            if (temperatura.temperatura2 <= limites.min_temperatura) {
                message2.innerHTML = '<b style="color:blue">Temperatura Baixa</b> <br> Critico'
            }
            if (temperatura.temperatura3 > 15 && temperatura.temperatura3 < 20) {
                message3.innerHTML = '<b style="color:green">Temperatura normal</b> <br> Ideal'
            }
            if (temperatura.temperatura3 >= limites.max_temperatura) {
                message3.innerHTML = '<b style="color:red">Temperatura Alta</b> <br> Critico'
            }
            if (temperatura.temperatura3 <= limites.min_temperatura) {
                message3.innerHTML = '<b style="color:blue">Temperatura Baixa</b> <br> Critico'
            }
        }

        // só altere aqui se souber o que está fazendo!
        function plotarGrafico(dados) {
            console.log('iniciando plotagem dos gráficos...');
            var chartTemperatura = new google.visualization.Gauge(div_temperatura);
            chartTemperatura.draw(dados.temperatura, configurarGrafico().temperatura);
            var chartTemperatura1 = new google.visualization.Gauge(div_temperatura1);
            chartTemperatura1.draw(dados.temperatura2, configurarGrafico().temperatura);
            var chartTemperatura2 = new google.visualization.Gauge(div_temperatura2);
            chartTemperatura2.draw(dados.temperatura3, configurarGrafico().temperatura);

        }
    </script>
    <!--Grafico historico-->
    <script>
        // Não mexa nestas 3 linhas! 
        google.load('visualization', '1', {
            packages: ['corechart', 'line'],
            callback: obterDadosgrafico
        });
        // Não mexa nessas 3 linhas! 
        // só mexer se quiser alterar o tempo de atualização
        // ou se souber o que está fazendo!

        function atualizartudo() {
            atualizarGrafico()
            atualizargrafico()
        }

        function atualizargrafico() {
            MediaGeral()
            obterDadosgrafico();
            setTimeout(atualizargrafico, 10000);
        }
        // altere aqui as configurações do gráfico
        // (tamanhos, cores, textos, etc)
        function configurargrafico() {
            var altura = 500;
            var largura = 500;
            var configuracoes = {
                tooltip: {
                    isHtml: true
                },
                trendlines: {
                    0: {
                        labelInLegend: 'Temperatura'
                    },

                },
                title: 'Histórico recente de temperatura',
                legend: {
                    position: 'bottom'
                },
                colors: ['blue'],
                isStacked: true,
                width: largura,
                height: altura,
                vAxis: {
                    textStyle: {
                        fontSize: 12
                    }
                },
                hAxis: {
                    slantedText: false,
                    slantedTextAngle: 45,
                    textStyle: {
                        fontSize: 10
                    }
                },
                chartArea: {
                    left: 50,
                    top: 20,
                    width: (largura - 10),
                    height: (altura - 90)
                }
            };
            return configuracoes;
        }
        // altere aqui como os dados serão exibidos
        // e como são recuperados do BackEnd
        function obterDadosgrafico() {
            var dados = new google.visualization.DataTable();
            dados.addColumn('string', 'Momento');
            dados.addColumn('number', 'Temperatura');
            var dados2 = new google.visualization.DataTable();
            dados2.addColumn('string', 'Momento');
            dados2.addColumn('number', 'Temperatura');
            var dados3 = new google.visualization.DataTable();
            dados3.addColumn('string', 'Momento');
            dados3.addColumn('number', 'Temperatura');
            fetch('/leituras/ultimas', {
                    cache: 'no-store'
                }).then(function(response) {
                    if (response.ok) {
                        response.json().then(function(resposta) {

                            console.log(`Dados recebidos: ${JSON.stringify(dados)}`);
                            resposta.reverse();
                            for (i = 0; i < resposta.length; i++) {
                                var registro = resposta[i];
                                // aqui, após registro. use os nomes 
                                // dos atributos que vem no JSON 
                                // que gerou na consulta ao banco de dados
                                dados.addRow([
                                    registro.dataEvento,
                                    parseInt(registro.temperaturaEvento),
                                ]);
                                dados2.addRow([
                                    registro.dataEvento,
                                    parseInt(registro.temperaturaEvento) - 10,
                                ]);
                                dados3.addRow([
                                    registro.dataEvento,
                                    parseInt(registro.temperaturaEvento) - 5,
                                ]);
                            }
                            plotargrafico(dados);
                            plotargrafico2(dados2);
                            plotargrafico3(dados3);
                        });
                    } else {
                        console.error('Nenhum dado encontrado ou erro na API');
                    }
                })
                .catch(function(error) {
                    console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
                });
        }
        // só altere aqui se souber o que está fazendo!
        function plotargrafico(dados1) {
            console.log('iniciando plotagem do gráfico...');
            var chart = new google.visualization.LineChart(div_grafico);
            chart.draw(dados1, configurargrafico());
        }

        function plotargrafico2(dados2) {
            console.log('iniciando plotagem do gráfico...');
            var chart1 = new google.visualization.LineChart(div_grafico1);
            chart1.draw(dados2, configurargrafico());
        }

        function plotargrafico3(dados3) {
            console.log('iniciando plotagem do gráfico...');
            var chart2 = new google.visualization.LineChart(div_grafico2);
            chart2.draw(dados3, configurargrafico());
        }
    </script>

    <script>
        function MediaGeral() {
            fetch('/leituras/media', {

            }).then((sucesso) => {
                if (sucesso.ok) {
                    sucesso.json().then((media) => {

                        /* var valores = Number(media.Media) - 15
                         media_atual.innerHTML = ''
                         if (valores > 37) {
                             media_atual.innerHTML += `<b style='color:red; font-size:30px'>${valores.toFixed(2)}ºC</b> <br><br>`
                             media_atual.innerHTML += `<b style='color:red; font-size:15px'>Temperatura Média Critica</b>`
                         } else if (valores >= 26) {
                             media_atual.innerHTML += `<b style='color:green; font-size:30px'>${valores.toFixed(2)}ºC</b> <br><br>`
                             media_atual.innerHTML += `<b style='color:green; font-size:15px'>Temperatura Média Ideal</b>`
                         } else {
                             media_atual.innerHTML += `<b style='color:red; font-size:30px'>${valores.toFixed(2)}ºC</b> <br><br>`
                             media_atual.innerHTML += `<b style='color:red; font-size:15px'>Temperatura Média Critica</b>`
                         }
                         */

                        media_atual.innerHTML = ''
                        if (media.Media > 37) {
                            media_atual.innerHTML += `<b style='color:red; font-size:30px'>${media.Media.toFixed(2)}ºC</b> <br><br>`
                            media_atual.innerHTML += `<b style='color:red; font-size:15px'>Temperatura Média Critica</b>`
                        } else if (media.Media >= 26) {
                            media_atual.innerHTML += `<b style='color:green; font-size:30px'>${media.Media.toFixed(2)}ºC</b> <br><br>`
                            media_atual.innerHTML += `<b style='color:green; font-size:15px'>Temperatura Média Ideal</b>`
                        } else {
                            media_atual.innerHTML += `<b style='color:red; font-size:30px'>${media.Media.toFixed(2)}ºC</b> <br><br>`
                            media_atual.innerHTML += `<b style='color:red; font-size:15px'>Temperatura Média Critica</b>`
                        }


                    })
                } else {
                    alert('Não foi possivel localizar')
                }
            }).catch((err) => {
                alert(err.message)
            })
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>

    <script type="text/javascript" src="https://assets.freshservice.com/widget/freshwidget.js"></script>
    <script type="text/javascript">
        FreshWidget.init("", {
            "queryString": "&widgetType=popup&submitThanks=Seu+ticket+foi+criado+com+sucesso",
            "utf8": "✓",
            "widgetType": "popup",
            "buttonType": "text",
            "buttonText": "Suporte",
            "buttonColor": "white",
            "buttonBg": "#00830C",
            "alignment": "2",
            "offset": "235px",
            "submitThanks": "Seu ticket foi criado com sucesso",
            "formHeight": "500px",
            "url": "https://corallifeservicedesk.freshservice.com"
        });
    </script>

</body>

<script>
    function initFreshChat() {
        window.fcWidget.init({
            token: "1db4c39e-36f7-47c7-869f-463d9c33440f",
            host: "https://wchat.freshchat.com"
        });
    }

    function initialize(i, t) {
        var e;
        i.getElementById(t) ? initFreshChat() : ((e = i.createElement("script")).id = t, e.async = !0, e.src = "https://wchat.freshchat.com/js/widget.js", e.onload = initFreshChat, i.head.appendChild(e))
    }

    function initiateCall() {
        initialize(document, "freshchat-js-sdk")
    }
    window.addEventListener ? window.addEventListener("load", initiateCall, !1) : window.attachEvent("load", initiateCall, !1);
</script>

<script>
    function myFunction() {
        /* Get the text field */
        var copyText = document.getElementById("myInput");

        /* Select the text field */
        copyText.select();
        copyText.setSelectionRange(0, 99999); /*For mobile devices*/

        /* Copy the text inside the text field */
        document.execCommand("copy");

        /* Alert the copied text */
        alert("Copied the text: " + copyText.value);
    }
</script>



</html>